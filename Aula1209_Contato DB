

Novo projeto → Java Web → Aplicação Web (ContatoDBCRUD) 
OBS.: trocar UTF=8 para:windows-1252
Obs.:  bootstrap: index, listaBD e alteraBD.

Obs: Mandar banco de dados junto com o programa:
Janela → Serviços → (lado esquerdo) → Banco de Dados → JavaDB → Java20253 → bd Propriedades → copiar localização banco de dados → explorador de arquivos, colar no início → zipa o banco de dados

Janela → Serviços → (lado esquerdo) → Banco de Dados → JavaDB → criar banco de dados → Java20253, usuário java3 e senha java3 → conectar
jdbc:derby://localhost:1527/Java20253 [java3 em JAVA3] → JAVA3 → Tabelas → bd Executar Comando...

create table contatos (

id INT PRIMARY KEY GENERATED ALWAYS AS IDENTITY,

nome VARCHAR(255),

email VARCHAR(255),

endereco VARCHAR(255),

dataNascimento DATE);

bd na tela → Executar Instrução

Páginas Web → Novo → Pasta → imagens → cola imagem

•  inserir() → grava
•  listar() → lista (index)
•  atualizar() → altera (alteraBD formulário, altera código)
•  excluir() → exclui

OBS.: trocar UTF=8 para:windows-1252
Index.html (Formulário)
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
<title>Primeiro Formulário</title>
</head>
<body>
<div class="container">
<h1> Cadastro de Contatos</h1>
<br>
<br>
<form class="form-horizontal" name="Formulario" action="gravaBD.jsp" method="post">
<div class="form-group">
<label class="col-sm-2 control-label">Nome: </label>
<div class="col-sm-8">
<input class="form-control" type="text" name="nome" required/> 
</div>
</div>

<div class="form-group">
<label class="col-sm-2 control-label">E-mail: </label>
<div class="col-sm-8">
<input class="form-control" type="text" name="email" /> 
</div>
</div>

<div class="form-group">
<label class="col-sm-2 control-label">Endereço: </label>
<div class="col-sm-8">
<input class="form-control" type="text" name="endereco" /> 
</div>
</div>


<div class="form-group">
<label class="col-sm-2 control-label">Data Nascimento: </label>
<div class="col-sm-8">
<input class="form-control" type="text" name="dtNasc" /> 
</div>
</div>

<div class="form-group">
<div class="col-sm-offset-2 col-sm-10">
<input class="btn btn-success" type="button" value="Gravar" onclick="Formulario.submit();
Formulario.reset();"/>
<input class="btn btn-danger" type="reset" value="Limpar" >

</div>
</div>

</form>
<div class="form-group">
<div class="col-sm-offset-3 col-sm-10">
<a class="btn btn-default" href="listaBD.jsp" role="button">Listar os Contatos em Tabela</a>
</div>
</div>
</div>
</body>
</html>



gravaBD.JSP
<%@page contentType="text/html" pageEncoding="windows-1252"%>
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
 <%
   // buscando os par�metros no request
    String nome = request.getParameter("nome");
    String endereco = request.getParameter("endereco");
    String email = request.getParameter("email");
    String dataEmTexto = request.getParameter("dtNasc");
    Calendar dataNascimento = null;

    // fazendo a convers�o da data
    try {
        SimpleDateFormat data = new SimpleDateFormat("dd/MM/yyyy");
        data.setLenient(false);
        Date date = data.parse(dataEmTexto);
        dataNascimento = Calendar.getInstance();
        dataNascimento.setTime(date);
    } catch (ParseException e) {
%>
<html>
    <body>
        Erro de convers�o da data
        <br><br>
        <a href=javascript:history.back()> &lt;&lt; Voltar </a>
    </body>
</html>
<%
        return; //para a execu��o do m�todo
    }
    // conectando
    Class.forName("org.apache.derby.jdbc.ClientDriver");
    String url = "jdbc:derby://localhost:1527/Java20253";
    Connection con = DriverManager.getConnection(url, "java3", "java3");
    // cria um preparedStatement
    String sql = "insert into contatos"
            + " (nome,email,endereco,dataNascimento)"
            + " values (?,?,?,?)";
    try {
        // prepared statement para inser��o
        PreparedStatement stmt = con.prepareStatement(sql);
        // seta os valores
        stmt.setString(1, nome);
        stmt.setString(2, email);
        stmt.setString(3, endereco);
   stmt.setDate(4, new java.sql.Date(dataNascimento.getTimeInMillis()));
        // executa
        stmt.execute();
        stmt.close();
    } catch (SQLException e) {
        throw new RuntimeException(e);
    }
%>
<html>
    <head>
        <title>Contatos</title>
    </head>
    <body>
        <h1>Contato <%=nome%> Inserido com Sucesso! </h1>
        <br><br><br>
    </body>
</html>



listaBD.jsp
<%@page contentType="text/html" pageEncoding="windows-1252"%>
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
        <title>Lista de Contatos</title>
        <%
            // conectando
            Class.forName("org.apache.derby.jdbc.ClientDriver");
            String url = "jdbc:derby://localhost:1527/Java20253";
            Connection con = DriverManager.getConnection(url, "java3", "java3");
        %>
    </head>
    <body>
        <%      try {
                java.sql.Statement statement = con.createStatement();
                ResultSet resultados = 
                        statement.executeQuery("SELECT * FROM Contatos");
        %>
        <table class="table table-striped" >
            <tr><th>Nome</th>
                <th>Endere�o</th>
                <th>E-mail</th>
                <th>Dt.Nasc.</th>
                <th>Alterar</th>
                <th>Excluir</th>
            </tr>
                    <% while (resultados.next()) {%>
            <tr>
                <td><%=resultados.getString("nome")%></td>
                <td><%=resultados.getString("endereco")%></td>
                <td><%=resultados.getString("email")%></td>
                <td><%=new SimpleDateFormat
        ("dd/MM/yyyy").format(resultados.getDate("dataNascimento"))%></td>
                <td align="center"><a 
                        href="alteraBD.jsp?id=<%=resultados.getInt("id")%>">
                        <img src="imagens/ticado.jpg" ></a></td>
                <td align="center"><a 
                        href="excluiBD.jsp?id=<%=resultados.getInt("id")%>">
                        <img src="imagens/x.jpg"></a></td>
            </tr>
            <%     }
                    resultados.close();
                } catch (SQLException e) {
                    throw new RuntimeException(e);
                }
            %>
        </table>
    </body>
</html>



alteraBD.jsp
<%@page contentType="text/html" pageEncoding="windows-1252"%>
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
        <title>Alteração de Contato</title>
        <%
            // conectando
            Class.forName("org.apache.derby.jdbc.ClientDriver");
            String url = "jdbc:derby://localhost:1527/Java2025";
            Connection con = DriverManager.getConnection(url, "java", "java");
        %>
    </head>
    <body> 
        <div class="container">
            <h1> Alteração de Contatos</h1>
            <br>
            <br>
            <%
                int id = Integer.parseInt(request.getParameter("id"));
                try {
                    PreparedStatement ps = con.prepareStatement(
                            "SELECT * FROM Contatos where id=?");
                    ps.setInt(1, id);
                    ResultSet resultados = ps.executeQuery();
                    resultados.next();%>
            <form class="form-horizontal" name="Formulario" action="altera.jsp" method="get">
                <div class="form-group">
                    <label  class="col-sm-2 control-label">Nome: </label>
                    <div class="col-sm-8">
                        <input class="form-control" type="text" name="nome" 
                               value="<%=resultados.getString("nome")%>"/> 
                    </div>
                </div>
                <input type="hidden" name="id" 
                       value="<%=resultados.getInt("id")%>"/>    

                <div class="form-group">
                    <label  class="col-sm-2 control-label">E-mail: </label>
                    <div class="col-sm-8">
                        <input class="form-control" type="text" name="email" 
                               value="<%=resultados.getString("email")%>"/> 
                    </div>
                </div>

                <div class="form-group">
                    <label  class="col-sm-2 control-label">Endereço: </label>
                    <div class="col-sm-8">
                        <input class="form-control" type="text" name="endereco" 
                               value="<%=resultados.getString("endereco")%>"/>  
                    </div>
                </div>

                    <div class="form-group">
                    <label  class="col-sm-2 control-label">Data Nascimento: </label>
                    <div class="col-sm-8">
                        <input  class="form-control" type="text" name="dtNasc" 
                                value="<%=new 
    SimpleDateFormat("dd/MM/yyyy").format(resultados.getDate("dataNascimento"))%>"/> 
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-10">
                        <input class="btn btn-success" type="button" value="Gravar" 
                               onclick="Formulario.submit();"/>
                    </div>
                </div>

            </form>
            <%
                    resultados.close();
                } catch (SQLException e) {
                    throw new RuntimeException(e);
                }
            %>
            <div class="form-group">
                <div class="col-sm-offset-3 col-sm-10">
                    <a class="btn btn-default" href="listaBD.jsp" role="button">Listar os Contatos em Tabela</a>
                </div>
            </div>
        </div>
    </body>
</html>




altera.jsp
<%@page import="java.sql.SQLException"%>
<%@page import="java.sql.DriverManager"%>
<%@page import="java.sql.PreparedStatement"%>
<%@page import="java.sql.Connection"%>
<%@page import="java.sql.Connection"%>
<%
    // buscando os par�metros no request
    int id = Integer.parseInt(request.getParameter("id"));
    String nome = request.getParameter("nome");
    String endereco = request.getParameter("endereco");
    String email = request.getParameter("email");
    String dataEmTexto = request.getParameter("dtNasc");
    Calendar dataNascimento = null;

    // fazendo a convers�o da data
    try {
        SimpleDateFormat data = new SimpleDateFormat("dd/MM/yyyy");
        data.setLenient(false);
        Date date = data.parse(dataEmTexto);
        dataNascimento = Calendar.getInstance();
        dataNascimento.setTime(date);
    } catch (ParseException e) {
%>
<html>
    <body>
        Erro de convers�o da data
        <br><br>
        <a href=javascript:history.back()> &lt;&lt; Voltar </a>
    </body>
</html>
<%
        return; //para a execu��o do m�todo
    }
    // conectando
    Class.forName("org.apache.derby.jdbc.ClientDriver");
    String url = "jdbc:derby://localhost:1527/Java20253";
    Connection con = DriverManager.getConnection(url, "java3", "java3");

    // cria um preparedStatement
    String sql = "update contatos"
            + "  set nome=?,email=?,endereco=?,dataNascimento=?"
            + " where id=?";
    try {
        // prepared statement para inser��o
        PreparedStatement stmt = con.prepareStatement(sql);
        // seta os valores
        stmt.setString(1, nome);
        stmt.setString(2, email);
        stmt.setString(3, endereco);
        stmt.setDate(4, new java.sql.Date(dataNascimento.getTimeInMillis()));
        stmt.setInt(5, id);
        // executa
        stmt.execute();
        stmt.close();
    } catch (SQLException e) {
        throw new RuntimeException(e);
    }
    response.sendRedirect("listaBD.jsp");
%>




excluiBD.jsp
<%@page contentType="text/html" pageEncoding="windows-1252"%>
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
        <title>Confirma Exclusão</title>
    </head>
    <body>
        <% int id = Integer.parseInt(request.getParameter("id"));%>
        <script>
            if (confirm("Tem certeza que deseja excluir contato ?")) {
                window.location = "exclui.jsp?id=<%=id%>";
            } else { 
                window.location = "listaBD.jsp";
            }
        </script>
    </body>
</html>

exclui.jsp	
%@page contentType="text/html" pageEncoding="windows-1252"%>
<!DOCTYPE html>
<%
// buscando os parâmetros no request
    int id = Integer.parseInt(request.getParameter("id"));
    // conectando
    Class.forName("org.apache.derby.jdbc.ClientDriver");
    String url = "jdbc:derby://localhost:1527/Java20253";
    Connection con = DriverManager.getConnection(url, "java3", "java3");

    try {
        PreparedStatement ps = con.prepareStatement(
                "delete from Contatos where id=?");
        ps.setInt(1, id);
        ps.execute();
    } catch (SQLException e) {
        throw new RuntimeException(e);
    }
    response.sendRedirect("listaBD.jsp");
%>
